{"version":3,"file":"vs/editor/common/services/languagesRegistry.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/editor/common/services/languagesRegistry.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {onUnexpectedError} from 'vs/base/common/errors';\nimport Event, {Emitter} from 'vs/base/common/event';\nimport * as mime from 'vs/base/common/mime';\nimport * as strings from 'vs/base/common/strings';\nimport {ILegacyLanguageDefinition, ModesRegistry} from 'vs/editor/common/modes/modesRegistry';\nimport {ILanguageExtensionPoint} from 'vs/editor/common/services/modeService';\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport interface ICompatModeDescriptor {\n\tmoduleId: string;\n\tctorName: string;\n}\n\nexport class LanguagesRegistry {\n\n\tprivate knownModeIds: { [id: string]: boolean; };\n\tprivate mime2LanguageId: { [mimeType: string]: string; };\n\tprivate name2LanguageId: { [name: string]: string; };\n\tprivate name2Extensions: { [name: string]: string[]; };\n\tprivate id2Name: { [id: string]: string; };\n\tprivate compatModes: { [id: string]: ICompatModeDescriptor; };\n\tprivate lowerName2Id: { [name: string]: string; };\n\tprivate id2ConfigurationFiles: { [id:string]: string[]; };\n\n\tprivate _onDidAddModes: Emitter<string[]> = new Emitter<string[]>();\n\tpublic onDidAddModes: Event<string[]> = this._onDidAddModes.event;\n\n\tconstructor(useModesRegistry = true) {\n\t\tthis.knownModeIds = {};\n\t\tthis.mime2LanguageId = {};\n\t\tthis.name2LanguageId = {};\n\t\tthis.id2Name = {};\n\t\tthis.name2Extensions = {};\n\t\tthis.compatModes = {};\n\t\tthis.lowerName2Id = {};\n\t\tthis.id2ConfigurationFiles = {};\n\n\t\tif (useModesRegistry) {\n\t\t\tthis._registerCompatModes(ModesRegistry.getCompatModes());\n\t\t\tModesRegistry.onDidAddCompatModes((m) => this._registerCompatModes(m));\n\n\t\t\tthis._registerLanguages(ModesRegistry.getLanguages());\n\t\t\tModesRegistry.onDidAddLanguages((m) => this._registerLanguages(m));\n\t\t}\n\t}\n\n\t_registerCompatModes(defs:ILegacyLanguageDefinition[]): void {\n\t\tlet addedModes: string[] = [];\n\t\tfor (let i = 0; i < defs.length; i++) {\n\t\t\tlet def = defs[i];\n\n\t\t\tthis._registerLanguage({\n\t\t\t\tid: def.id,\n\t\t\t\textensions: def.extensions,\n\t\t\t\tfilenames: def.filenames,\n\t\t\t\tfirstLine: def.firstLine,\n\t\t\t\taliases: def.aliases,\n\t\t\t\tmimetypes: def.mimetypes\n\t\t\t});\n\n\t\t\tthis.compatModes[def.id] = {\n\t\t\t\tmoduleId: def.moduleId,\n\t\t\t\tctorName: def.ctorName\n\t\t\t};\n\n\t\t\taddedModes.push(def.id);\n\t\t}\n\t\tthis._onDidAddModes.fire(addedModes);\n\t}\n\n\t_registerLanguages(desc:ILanguageExtensionPoint[]): void {\n\t\tlet addedModes: string[] = [];\n\t\tfor (let i = 0; i < desc.length; i++) {\n\t\t\tthis._registerLanguage(desc[i]);\n\t\t\taddedModes.push(desc[i].id);\n\t\t}\n\t\tthis._onDidAddModes.fire(addedModes);\n\t}\n\n\tprivate _registerLanguage(lang: ILanguageExtensionPoint): void {\n\t\tthis.knownModeIds[lang.id] = true;\n\n\t\tvar primaryMime: string = null;\n\n\t\tif (typeof lang.mimetypes !== 'undefined' && Array.isArray(lang.mimetypes)) {\n\t\t\tfor (var i = 0; i < lang.mimetypes.length; i++) {\n\t\t\t\tif (!primaryMime) {\n\t\t\t\t\tprimaryMime = lang.mimetypes[i];\n\t\t\t\t}\n\t\t\t\tthis.mime2LanguageId[lang.mimetypes[i]] = lang.id;\n\t\t\t}\n\t\t}\n\n\t\tif (!primaryMime) {\n\t\t\tprimaryMime = 'text/x-' + lang.id;\n\t\t\tthis.mime2LanguageId[primaryMime] = lang.id;\n\t\t}\n\n\t\tif (Array.isArray(lang.extensions)) {\n\t\t\tfor (let extension of lang.extensions) {\n\t\t\t\tmime.registerTextMime({ mime: primaryMime, extension: extension });\n\t\t\t}\n\t\t}\n\n\t\tif (Array.isArray(lang.filenames)) {\n\t\t\tfor (let filename of lang.filenames) {\n\t\t\t\tmime.registerTextMime({ mime: primaryMime, filename: filename });\n\t\t\t}\n\t\t}\n\n\t\tif (Array.isArray(lang.filenamePatterns)) {\n\t\t\tfor (let filenamePattern of lang.filenamePatterns) {\n\t\t\t\tmime.registerTextMime({ mime: primaryMime, filepattern: filenamePattern });\n\t\t\t}\n\t\t}\n\n\t\tif (typeof lang.firstLine === 'string' && lang.firstLine.length > 0) {\n\t\t\tvar firstLineRegexStr = lang.firstLine;\n\t\t\tif (firstLineRegexStr.charAt(0) !== '^') {\n\t\t\t\tfirstLineRegexStr = '^' + firstLineRegexStr;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar firstLineRegex = new RegExp(firstLineRegexStr);\n\t\t\t\tif (!strings.regExpLeadsToEndlessLoop(firstLineRegex)) {\n\t\t\t\t\tmime.registerTextMime({ mime: primaryMime, firstline: firstLineRegex });\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\t// Most likely, the regex was bad\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\tthis.lowerName2Id[lang.id.toLowerCase()] = lang.id;\n\n\t\tif (typeof lang.aliases !== 'undefined' && Array.isArray(lang.aliases)) {\n\t\t\tfor (var i = 0; i < lang.aliases.length; i++) {\n\t\t\t\tif (!lang.aliases[i] || lang.aliases[i].length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis.lowerName2Id[lang.aliases[i].toLowerCase()] = lang.id;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.id2Name[lang.id]) {\n\t\t\tlet bestName = null;\n\n\t\t\tif (typeof lang.aliases !== 'undefined' && Array.isArray(lang.aliases) && lang.aliases.length > 0) {\n\t\t\t\tbestName = lang.aliases[0];\n\t\t\t} else {\n\t\t\t\tbestName = lang.id;\n\t\t\t}\n\n\t\t\tif (bestName) {\n\t\t\t\tthis.name2LanguageId[bestName] = lang.id;\n\t\t\t\tthis.name2Extensions[bestName] = lang.extensions;\n\t\t\t\tthis.id2Name[lang.id] = bestName || '';\n\t\t\t}\n\t\t}\n\n\t\tif (typeof lang.configuration === 'string') {\n\t\t\tthis.id2ConfigurationFiles[lang.id] = this.id2ConfigurationFiles[lang.id] || [];\n\t\t\tthis.id2ConfigurationFiles[lang.id].push(lang.configuration);\n\t\t}\n\t}\n\n\tpublic isRegisteredMode(mimetypeOrModeId: string): boolean {\n\t\t// Is this a known mime type ?\n\t\tif (hasOwnProperty.call(this.mime2LanguageId, mimetypeOrModeId)) {\n\t\t\treturn true;\n\t\t}\n\t\t// Is this a known mode id ?\n\t\treturn hasOwnProperty.call(this.knownModeIds, mimetypeOrModeId);\n\t}\n\n\tpublic getRegisteredModes(): string[] {\n\t\treturn Object.keys(this.knownModeIds);\n\t}\n\n\tpublic getRegisteredLanguageNames(): string[]{\n\t\treturn Object.keys(this.name2LanguageId);\n\t}\n\n\tpublic getLanguageName(modeId: string): string {\n\t\treturn this.id2Name[modeId] || null;\n\t}\n\n\tpublic getModeIdForLanguageNameLowercase(languageNameLower: string): string {\n\t\treturn this.lowerName2Id[languageNameLower] || null;\n\t}\n\n\tpublic getConfigurationFiles(modeId: string): string[] {\n\t\treturn this.id2ConfigurationFiles[modeId] || [];\n\t}\n\n\tpublic getMimeForMode(theModeId: string): string {\n\t\tlet keys = Object.keys(this.mime2LanguageId);\n\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\tlet _mime = keys[i];\n\t\t\tlet modeId = this.mime2LanguageId[_mime];\n\t\t\tif (modeId === theModeId) {\n\t\t\t\treturn _mime;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tpublic extractModeIds(commaSeparatedMimetypesOrCommaSeparatedIdsOrName: string): string[] {\n\t\tif (!commaSeparatedMimetypesOrCommaSeparatedIdsOrName) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn (\n\t\t\tcommaSeparatedMimetypesOrCommaSeparatedIdsOrName.\n\t\t\t\tsplit(',').\n\t\t\t\tmap((mimeTypeOrIdOrName) => mimeTypeOrIdOrName.trim()).\n\t\t\t\tmap((mimeTypeOrIdOrName) => {\n\t\t\t\t\treturn this.mime2LanguageId[mimeTypeOrIdOrName] || mimeTypeOrIdOrName;\n\t\t\t\t}).\n\t\t\t\tfilter((modeId) => {\n\t\t\t\t\treturn this.knownModeIds[modeId];\n\t\t\t\t})\n\t\t);\n\t}\n\n\tpublic getModeIdsFromLanguageName(languageName: string): string[]{\n\t\tif (!languageName) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (hasOwnProperty.call(this.name2LanguageId, languageName)) {\n\t\t\treturn [this.name2LanguageId[languageName]];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tpublic getModeIdsFromFilenameOrFirstLine(filename: string, firstLine?:string): string[] {\n\t\tif (!filename && !firstLine) {\n\t\t\treturn [];\n\t\t}\n\t\tvar mimeTypes = mime.guessMimeTypes(filename, firstLine);\n\t\treturn this.extractModeIds(mimeTypes.join(','));\n\t}\n\n\tpublic getCompatMode(modeId: string): ICompatModeDescriptor {\n\t\treturn this.compatModes[modeId] || null;\n\t}\n\n\tpublic getExtensions(languageName: string): string[] {\n\t\treturn this.name2Extensions[languageName];\n\t}\n}\n"]}